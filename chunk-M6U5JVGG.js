import{a as Z}from"./chunk-I2CVAPWO.js";import{a as $,b as g,c as R,d as U,i as Y,l as H,m as J,u as L,v as W,w as K}from"./chunk-BA4ST442.js";import{k as M,p as ie,q as Q,r as X}from"./chunk-VGTTCDMY.js";import{Bb as A,Ea as l,Fa as h,Hb as T,Ib as D,Sa as c,Ua as m,Wa as x,_ as N,ab as e,bb as i,cb as u,e as te,ec as q,fc as z,ga as E,gb as B,ha as I,hb as p,ib as b,ic as G,lb as O,m as w,mc as V,tb as r,ub as j,vb as k,wb as F,za as P}from"./chunk-MEK6ZYR6.js";var v=te(ie());function ne(o,a){o&1&&(e(0,"div",21),r(1," This feature is currently unavailable. "),i())}function re(o,a){o&1&&(e(0,"div",34),r(1," Name is required. "),i())}function oe(o,a){o&1&&(e(0,"div",34),r(1," Valid email is required. "),i())}function le(o,a){o&1&&(e(0,"div",34),r(1," Phone must be 11 digits. "),i())}function ae(o,a){o&1&&(e(0,"div",34),r(1," Address is required. "),i())}function me(o,a){if(o&1&&(e(0,"div")(1,"label",23),r(2,"Name"),i(),e(3,"div",6),u(4,"input",24),c(5,re,2,0,"div",25),i(),e(6,"label",26),r(7,"Email"),i(),e(8,"div",6),u(9,"input",27),c(10,oe,2,0,"div",25),i(),e(11,"label",28),r(12,"Phone Number"),i(),e(13,"div",6),u(14,"input",29),c(15,le,2,0,"div",25),i(),e(16,"label",30),r(17,"Address 1"),i(),e(18,"div",6),u(19,"input",31),c(20,ae,2,0,"div",25),i(),e(21,"label",32),r(22,"Address 2 (Optional)"),i(),e(23,"div",6),u(24,"input",33),i()()),o&2){let n,t,d,f,_,y,S,C,s=b(2);l(4),x("border-red-500",((n=s.billingForm.get("name"))==null?null:n.touched)&&((n=s.billingForm.get("name"))==null?null:n.invalid)),l(),m("ngIf",((t=s.billingForm.get("name"))==null?null:t.touched)&&((t=s.billingForm.get("name"))==null?null:t.invalid)),l(4),x("border-red-500",((d=s.billingForm.get("email"))==null?null:d.touched)&&((d=s.billingForm.get("email"))==null?null:d.invalid)),l(),m("ngIf",((f=s.billingForm.get("email"))==null?null:f.touched)&&((f=s.billingForm.get("email"))==null?null:f.invalid)),l(4),x("border-red-500",((_=s.billingForm.get("phone"))==null?null:_.touched)&&((_=s.billingForm.get("phone"))==null?null:_.invalid)),l(),m("ngIf",((y=s.billingForm.get("phone"))==null?null:y.touched)&&((y=s.billingForm.get("phone"))==null?null:y.invalid)),l(4),x("border-red-500",((S=s.billingForm.get("address1"))==null?null:S.touched)&&((S=s.billingForm.get("address1"))==null?null:S.invalid)),l(),m("ngIf",((C=s.billingForm.get("address1"))==null?null:C.touched)&&((C=s.billingForm.get("address1"))==null?null:C.invalid))}}function de(o,a){if(o&1){let n=B();e(0,"div")(1,"form",22),p("ngSubmit",function(){E(n);let d=b();return I(d.onSubmit())}),c(2,me,25,12,"div",15),i()()}if(o&2){let n=b();l(),m("formGroup",n.billingForm),l(),m("ngIf",n.checkoutData.items&&n.checkoutData.items.length>0)}}function se(o,a){o&1&&u(0,"div",35)}function ce(o,a){if(o&1){let n=B();e(0,"div",43)(1,"img",44),p("error",function(d){E(n);let f=b(2);return I(f.onImageError(d))}),i(),e(2,"div",45)(3,"span",46),r(4),i(),e(5,"span",47),r(6),i(),e(7,"p",48),r(8),i()()()}if(o&2){let n=a.$implicit;l(),O("alt",n.name),m("src",n.image,P),l(3),j(n.name),l(2),F("Color: ",n.color,", Size: ",n.size,""),l(2),F(" $",n.price," x ",n.quantity," ")}}function ue(o,a){if(o&1&&(e(0,"div"),c(1,ce,9,7,"div",36),e(2,"div",37)(3,"div",38)(4,"p",39),r(5,"Subtotal"),i(),e(6,"p",40),r(7),i()(),e(8,"div",38)(9,"p",39),r(10,"Shipping"),i(),e(11,"p",40),r(12),i()()(),e(13,"div",41)(14,"p",39),r(15,"Total"),i(),e(16,"p",42),r(17),i()()()),o&2){let n=b();l(),m("ngForOf",n.checkoutData.items),l(6),k(" $",n.checkoutData.summary.subtotal," "),l(5),k(" $",n.checkoutData.summary.shippingCost," "),l(5),k(" $",n.checkoutData.summary.total," ")}}function pe(o,a){o&1&&(e(0,"div",49),r(1," No items in your order. "),i())}var ee=class o{constructor(a,n,t,d){this.fb=a;this.router=n;this.customerService=t;this.userAuthService=d}cash=new w(!0);bank=new w(!1);showBankTooltip=!1;checkoutData={};billingForm;customerId="";cartIds=[];loginSubscription=null;ngOnInit(){let a=localStorage.getItem("checkoutData");a?(this.checkoutData=JSON.parse(a),this.checkoutData.items&&(this.cartIds=this.checkoutData.items.map(t=>t.id),this.checkoutData.items.forEach(t=>{t.image&&!t.image.startsWith("https:")&&(t.image="https:"+t.image)}))):v.default.fire({icon:"warning",title:"Empty Cart",text:"You need to add products to your cart first!",confirmButtonText:"Go to Shop",showCancelButton:!0,cancelButtonText:"Go to Home"}).then(t=>{t.isConfirmed?this.router.navigate(["/shop"]):this.router.navigate(["/home"])}),this.billingForm=this.fb.group({name:["",g.required],email:["",[g.required,g.email]],phone:["",[g.required,g.pattern("^[0-9]{11}$")]],address1:["",g.required],address2:[""]});let n=localStorage.getItem("token")||"";if(n){let t=Q(n);this.customerId=t.ID}}selectPayment(a){a==="cash"?(this.cash.next(!0),this.bank.next(!1)):(this.cash.next(!0),this.bank.next(!1))}onSubmit(){this.billingForm.valid?v.default.fire({icon:"question",title:"Confirm Purchase",text:"Are you sure you want to place this order?",confirmButtonText:"Yes, Place Order",showCancelButton:!0,cancelButtonText:"Cancel"}).then(a=>{if(a.isConfirmed){let n={customerId:this.customerId,address:this.billingForm.value.address1,phone:this.billingForm.value.phone};this.customerService.addOrder(n).subscribe({next:t=>{console.log("Add Order Response:",t),localStorage.removeItem("checkoutData"),this.checkoutData={},v.default.fire({icon:"success",title:"Order Placed Successfully",text:"Your order has been placed!",timer:2e3,showConfirmButton:!1}).then(()=>{this.loginSubscription=this.userAuthService.isUserLogin.subscribe(d=>{d&&this.customerId&&this.customerService.loadCartItems(this.customerId)}),this.router.navigate(["/home"])})},error:t=>{console.log(t),v.default.fire({icon:"error",title:"Error",text:"Failed to place order. Please try again."})}})}}):v.default.fire({icon:"warning",title:"Incomplete Form",text:"Please fill all required fields before proceeding."})}onImageError(a){let n=a.target;n.src="https://fakeimg.pl/300/"}static \u0275fac=function(n){return new(n||o)(h(L),h(M),h(Z),h(X))};static \u0275cmp=N({type:o,selectors:[["app-billing"]],standalone:!0,features:[A],decls:38,vars:14,consts:[[1,"grid","sm:px-10","lg:grid-cols-2","lg:px-20","xl:px-32","my-10"],[1,"mt-10","bg-gray-50","px-4","pt-8","lg:mt-0"],[1,"text-xl","font-medium"],[1,"text-gray-400"],[1,"mt-8","text-lg","font-medium"],[1,"mt-5","grid","grid-cols-2","gap-6",3,"ngSubmit","formGroup"],[1,"relative"],["id","radio_1","type","radio","name","radio",1,"peer","hidden",3,"change","disabled","checked"],[1,"peer-checked:border-gray-700","absolute","right-4","top-1/2","box-content","block","h-3","w-3","-translate-y-1/2","rounded-full","border-8","border-gray-300","bg-white"],["for","radio_1",1,"peer-checked:border-2","peer-checked:border-gray-700","peer-checked:bg-gray-50","flex","cursor-not-allowed","select-none","rounded-lg","border","border-gray-300","p-4","bg-gray-100","text-gray-500","hover:bg-gray-200",3,"mouseover","mouseout"],[1,"mt-2","font-semibold"],["class","absolute left-0 -top-14 mt-2 w-48 p-2 bg-[var(--main-color)] text-white text-sm rounded-md shadow-lg z-10",4,"ngIf"],["id","radio_2","type","radio","name","radio",1,"peer","hidden",3,"change","checked"],[1,"peer-checked:border-[var(--main-color)]","absolute","right-4","top-1/2","box-content","block","h-3","w-3","-translate-y-1/2","rounded-full","border-8","border-[var(--main-color)]"],["for","radio_2",1,"peer-checked:border-2","peer-checked:border-[var(--main-color)]","peer-checked:bg-gray-50","flex","cursor-pointer","select-none","rounded-lg","border","border-[var(--main-color)]","p-4"],[4,"ngIf"],["class","hidden",4,"ngIf"],["type","submit",1,"mt-4","mb-8","w-full","cursor-pointer","rounded-md","bg-[var(--main-color)]","px-6","py-3","font-medium","text-white","transition","duration-200","disabled:cursor-not-allowed","disabled:opacity-50",3,"click","disabled"],[1,"px-4","pt-8"],[1,"mt-8","rounded-lg","border","bg-white","px-2","py-4","sm:px-6"],["class","text-center text-gray-500",4,"ngIf"],[1,"absolute","left-0","-top-14","mt-2","w-48","p-2","bg-[var(--main-color)]","text-white","text-sm","rounded-md","shadow-lg","z-10"],[1,"mt-5",3,"ngSubmit","formGroup"],["for","name",1,"mt-4","mb-2","block","text-sm","font-medium"],["type","text","id","name","formControlName","name",1,"w-full","rounded-md","border","border-gray-200","px-4","py-3","text-sm","shadow-sm","outline-none","focus:z-10","focus:border-[var(--main-color)]","focus:ring-[var(--main-color)]"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["for","email",1,"mt-4","mb-2","block","text-sm","font-medium"],["type","email","id","email","formControlName","email",1,"w-full","rounded-md","border","border-gray-200","px-4","py-3","text-sm","shadow-sm","outline-none","focus:z-10","focus:border-[var(--main-color)]","focus:ring-[var(--main-color)]"],["for","phone",1,"mt-4","mb-2","block","text-sm","font-medium"],["type","text","id","phone","formControlName","phone",1,"w-full","rounded-md","border","border-gray-200","px-4","py-3","text-sm","shadow-sm","outline-none","focus:z-10","focus:border-[var(--main-color)]","focus:ring-[var(--main-color)]"],["for","address1",1,"mt-4","mb-2","block","text-sm","font-medium"],["type","text","id","address1","formControlName","address1",1,"w-full","rounded-md","border","border-gray-200","px-4","py-3","text-sm","shadow-sm","outline-none","focus:z-10","focus:border-[var(--main-color)]","focus:ring-[var(--main-color)]"],["for","address2",1,"mt-4","mb-2","block","text-sm","font-medium"],["type","text","id","address2","formControlName","address2",1,"w-full","rounded-md","border","border-gray-200","px-4","py-3","text-sm","shadow-sm","outline-none","focus:z-10","focus:border-[var(--main-color)]","focus:ring-[var(--main-color)]"],[1,"text-red-500","text-sm","mt-1"],[1,"hidden"],["class","flex flex-col rounded-lg bg-white sm:flex-row mb-4",4,"ngFor","ngForOf"],[1,"mt-6","border-t","border-b","py-2"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-900"],[1,"font-semibold","text-gray-900"],[1,"mt-6","flex","items-center","justify-between"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"flex","flex-col","rounded-lg","bg-white","sm:flex-row","mb-4"],[1,"m-2","h-24","w-28","rounded-md","border","object-cover","object-center",3,"error","src","alt"],[1,"flex","w-full","flex-col","px-4","py-4"],[1,"font-semibold"],[1,"float-right","text-gray-400"],[1,"text-lg","font-bold"],[1,"text-center","text-gray-500"]],template:function(n,t){n&1&&(e(0,"div",0)(1,"div",1)(2,"p",2),r(3,"Payment Details"),i(),e(4,"p",3),r(5," Complete your order by providing your payment details. "),i(),e(6,"p",4),r(7,"Shipping Methods"),i(),e(8,"form",5),p("ngSubmit",function(){return t.onSubmit()}),e(9,"div",6)(10,"input",7),T(11,"async"),p("change",function(){return t.selectPayment("bank")}),i(),u(12,"span",8),e(13,"label",9),p("mouseover",function(){return t.showBankTooltip=!0})("mouseout",function(){return t.showBankTooltip=!1}),e(14,"div")(15,"span",10),r(16,"Bank"),i()(),c(17,ne,2,0,"div",11),i()(),e(18,"div",6)(19,"input",12),T(20,"async"),p("change",function(){return t.selectPayment("cash")}),i(),u(21,"span",13),e(22,"label",14)(23,"div")(24,"span",10),r(25,"Cash on Delivery"),i()()()()(),c(26,de,3,2,"div",15)(27,se,1,0,"div",16),e(28,"button",17),p("click",function(){return t.onSubmit()}),r(29," Place Order "),i()(),e(30,"div",18)(31,"p",2),r(32,"Order Summary"),i(),e(33,"p",3),r(34,"Check your items and confirm your order."),i(),e(35,"div",19),c(36,ue,18,4,"div",15)(37,pe,2,0,"div",20),i()()()),n&2&&(l(8),m("formGroup",t.billingForm),l(2),m("disabled",!0)("checked",D(11,10,t.bank)),l(7),m("ngIf",t.showBankTooltip),l(2),m("checked",D(20,12,t.cash)),l(7),m("ngIf",t.cash.value),l(),m("ngIf",t.bank.value),l(),m("disabled",t.billingForm.invalid),l(8),m("ngIf",t.checkoutData.items&&t.checkoutData.items.length>0),l(),m("ngIf",!t.checkoutData.items||t.checkoutData.items.length===0))},dependencies:[V,q,z,G,W,Y,$,R,U,K,H,J]})};export{ee as BillingComponent};
